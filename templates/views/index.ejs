<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

        var employeeInfo = [];
        var employees = {}
        fetch('/form/data')

            // creates promise to work with response from /api/data
            .then(res => {

                // throws error if there is a problem fetching page
                if (!res.ok) {

                    // returns error with response text of error
                    throw new Error(res.statusText);
                }
                return res.json();

            }).then(data => {

                // creates employees variable to store JSON data form /api/data
                employees = data;

                // creates empty employeeInfo array


                // console.log(employeeInfo)
                // console.log(data)
                // console.log("employees", employees)
            }).then(() => {
                google.charts.load("current", { packages: ["corechart"] });
                google.charts.setOnLoadCallback(drawChart);
                function drawChart() {
                    employeeInfo.push(['Gender', 'Total'])
                    const arrayDataMale = parseInt(employees.male)
                    employeeInfo.push(['Male', arrayDataMale])

                    const arrayDataFemale = parseInt(employees.female)
                    employeeInfo.push(['Female', arrayDataFemale])

                    console.log("employeeInfo", employeeInfo)

                    var data = google.visualization.arrayToDataTable(
                        employeeInfo);

                    var options = {
                        title: 'No of Beneficiaries',
                        pieHole: 0.5,
                    };

                    var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
                    chart.draw(data, options);
                }
            })


    </script>
</head>

<body>
    <div id="donutchart" style="width: 900px; height: 500px;"></div>


</body>

</html>